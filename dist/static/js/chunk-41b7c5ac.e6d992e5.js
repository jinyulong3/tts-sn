(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41b7c5ac"],{"972a":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{span:18}},[s("el-button",{attrs:{type:"primary"},on:{click:e.changeHandle}},[e._v("修改密码")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"}],attrs:{type:"warning"},on:{click:e.cancelHandle}},[e._v("取消")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"}],attrs:{type:"success"},on:{click:e.saveHandle}},[e._v("保存")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.edit,expression:"!edit"}],attrs:{type:"success"},on:{click:function(t){e.edit=!0}}},[e._v("编辑信息")])],1)],1),s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-col",{staticClass:"form",attrs:{span:18}},[s("el-form",{ref:"form",attrs:{model:e.personal,rules:e.personalRules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"账号"}},[s("el-input",{attrs:{readonly:""},model:{value:e.personal.account,callback:function(t){e.$set(e.personal,"account",t)},expression:"personal.account"}})],1),s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{readonly:!e.edit},model:{value:e.personal.name,callback:function(t){e.$set(e.personal,"name",t)},expression:"personal.name"}})],1),s("el-form-item",{attrs:{label:"公钥",prop:"pub"}},[s("el-input",{attrs:{rows:7,readonly:!e.edit,type:"textarea",placeholder:"更新请输入公钥，不更新不输入"},model:{value:e.personal.pub,callback:function(t){e.$set(e.personal,"pub",t)},expression:"personal.pub"}})],1)],1)],1)],1),s("el-dialog",{attrs:{title:"身份验证",visible:e.showConfirmDialog,center:""},on:{"update:visible":function(t){e.showConfirmDialog=t}}},[s("el-form",{ref:"confirm",attrs:{model:e.confirm,rules:e.confirmRules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.confirm.password,callback:function(t){e.$set(e.confirm,"password",t)},expression:"confirm.password"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.upadteInfo}},[e._v("确定")])],1)],1),s("el-dialog",{attrs:{title:"修改密码",visible:e.showChangeDialog,center:""},on:{"update:visible":function(t){e.showChangeDialog=t}}},[s("el-form",{ref:"change",attrs:{model:e.change,rules:e.changeRules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"原密码",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.change.password,callback:function(t){e.$set(e.change,"password",t)},expression:"change.password"}})],1),s("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[s("el-input",{attrs:{type:"password"},model:{value:e.change.newPassword,callback:function(t){e.$set(e.change,"newPassword",t)},expression:"change.newPassword"}})],1),s("el-form-item",{attrs:{label:"确认密码",prop:"checkPassword"}},[s("el-input",{attrs:{type:"password"},model:{value:e.change.checkPassword,callback:function(t){e.$set(e.change,"checkPassword",t)},expression:"change.checkPassword"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.changePassword}},[e._v("确定")])],1)],1)],1)},r=[],o=s("5530"),n=(s("b0c0"),s("498a"),{name:"Personal",props:{},data:function(){return{edit:!1,showConfirmDialog:!1,showChangeDialog:!1,personal:{account:this.$store.state.user.account,name:this.$store.state.user.name,pub:""},personalRules:{name:[{required:!0,trigger:"blur",validator:this.validateName}],pub:[{trigger:"blur",validator:this.validatePub}]},confirm:{password:""},confirmRules:{password:[{required:!0,message:"请输入密码",trigger:"blur"}]},change:{password:"",newPassword:"",checkPassword:""},changeRules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码不能少于6位",trigger:"blur"}],checkPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:this.validateCheckPass,trigger:"blur"}]}}},created:function(){},mounted:function(){},methods:{validateName:function(e,t,s){this.edit&&!t.trim().length?s(new Error("姓名不能为空")):s()},validatePub:function(e,t,s){this.edit&&t.trim().length?/^-----BEGIN PUBLIC KEY-----.*-----END PUBLIC KEY-----\$/.test(t.trim())?s():s(new Error("请输入正确的公钥")):s()},validateCheckPass:function(e,t,s){t!==this.change.newPassword?s(new Error("两次输入密码不一致!")):s()},saveHandle:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.confirm.password="",e.showConfirmDialog=!0}))},cancelHandle:function(){this.edit=!1,this.$refs.form.resetFields()},upadteInfo:function(){var e=this;this.$refs.confirm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$store.dispatch("user/updateInfo",Object(o["a"])(Object(o["a"])({},e.personal),{},{password:e.confirm.password})).then((function(){e.$notify({title:"成功",message:"信息修改成功",type:"success"}),e.edit=!1})),e.showConfirmDialog=!1}))},changeHandle:function(){this.change={},this.showChangeDialog=!0},changePassword:function(){var e=this;this.$refs.change.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$store.dispatch("user/changePassword",e.change).then((function(){e.$notify({title:"成功",message:"密码已修改",type:"success"})})),e.showChangeDialog=!1}))}}}),i=n,l=(s("9939"),s("2877")),c=Object(l["a"])(i,a,r,!1,null,"15f199f6",null);t["default"]=c.exports},9939:function(e,t,s){"use strict";s("d79b")},d79b:function(e,t,s){}}]);